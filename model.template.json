{
  "id": "stockquote-demo",
  "description": "Drives Load for Versioning Demo",
  "defaultProperties": {
    "scheme": "http",
    "host": "#org#-test.apigee.net",
    "headers": {
      "Accept": "application/json"
    }
  },
  "geoDistribution": 1,
  "initialContext": {
    "apikeys": [ 
      ["#customer-web-app#", 90],
      ["#public-website#", 53],
      ["#stock-android-app#", 54],
      ["#stock-ios-app#", 68],
      ["#popular-ios-app#", 70],
      ["#popular-android-app#", 33],
      ["#large-web-publisher#", 54],
      ["#stock-picker-app#", 6],
      ["#independent-researcher#", 5]
    ],
    "symbols": ["TGT", "WAG", "PZZA", "MS", "T", "AAPL", "GE", "XCO", "CHK", "APIC", "AMZN", "FB", "PG" , "F", "BAC", "KO"]
  },
  "invocationsPerHour": [
    545, 495, 515, 450, 419, 309, 613, 406,
    306, 593, 519, 629, 804, 711, 472, 528,
    235, 449, 371, 678, 355, 283, 486, 328],
  "variationByDayOfWeek" : [
        0.8, 1.0, 1.05, 1.26, 0.83, 1.37, 1.1
  ],


  "sequences": [{
    "iterations": "Math.floor(Math.random() * 5) + 2",
    "requests": [{
      "imports": [{
        "description": "setup the weighted random selector",
        "fn": "function(ctx) {return (ctx.kwrs)? ctx.kwrs : new WeightedRandomSelector(ctx.apikeys);}",
        "valueRef": "kwrs"
      }, {
        "description": "choose a key",
        "fn": "function(ctx) {return ctx.kwrs.select()[0];}",
        "valueRef": "apikey"
      },{
        "description": "choose a symbol",
        "fn": "function(ctx) {return  ctx.symbols[Math.floor(Math.random() * ctx.symbols.length)];}",
        "valueRef": "symbol"
      }],
      "url": "/v1/stocks/{symbol}/quote?apikey={apikey}",
      "method": "get",
      "delayBefore": 0
    }]
  },
  {
    "iterations": "Math.floor(Math.random() * 2) + 1",
    "requests": [{
      "imports": [{
        "description": "setup the weighted random selector",
        "fn": "function(ctx) {return (ctx.kwrs)? ctx.kwrs : new WeightedRandomSelector(ctx.apikeys);}",
        "valueRef": "kwrs"
      }, {
        "description": "choose a key",
        "fn": "function(ctx) {return ctx.v1kwrs.select()[0];}",
        "valueRef": "v1apikey"
      },{
        "description": "choose a symbol",
        "fn": "function(ctx) {return  ctx.symbols[Math.floor(Math.random() * ctx.symbols.length)];}",
        "valueRef": "symbol"
      }],
      "url": "/v1/stocks/{symbol}?apikey={apikey}",
      "method": "get",
      "delayBefore": 0
    }]
  },
  {
    "iterations": "Math.floor(Math.random() * 2) + 1",
    "requests": [{
      "imports": [{
        "description": "setup the weighted random selector",
        "fn": "function(ctx) {return (ctx.kwrs)? ctx.kwrs : new WeightedRandomSelector(ctx.apikeys);}",
        "valueRef": "kwrs"
      }, {
        "description": "choose a key",
        "fn": "function(ctx) {return ctx.v1kwrs.select()[0];}",
        "valueRef": "v1apikey"
      },{
        "description": "choose a symbol",
        "fn": "function(ctx) {return  ctx.symbols[Math.floor(Math.random() * ctx.symbols.length)];}",
        "valueRef": "symbol"
      }],
      "url": "/v1/stocks/{symbol}/historical-prices?days=20&apikey={apikey}",
      "method": "get",
      "delayBefore": 0
    }]
  }]
}
